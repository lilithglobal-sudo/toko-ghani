<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Admin Panel - Toko Ghani</title>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
body {
  font-family: Arial;
  background: #f2f2f2;
  padding: 20px;
}
.box {
  max-width: 400px;
  margin: auto;
  background: white;
  padding: 20px;
  border-radius: 8px;
}
input, button {
  width: 100%;
  padding: 10px;
  margin-top: 10px;
}
.product {
  background: #eee;
  padding: 10px;
  margin-top: 10px;
  border-radius: 5px;
}
img {
  width: 100%;
  margin-top: 5px;
}
</style>
</head>
<body>

<div class="box">
<h2>Admin - Toko Ghani</h2>

<input id="name" placeholder="Nama Produk">
<input id="price" type="number" placeholder="Harga">
<input id="stock" type="number" placeholder="Stok">
<input id="image" type="file" accept="image/*">

<button onclick="addProduct()">Tambah Produk</button>

<div id="list"></div>
</div>

<script>
var firebaseConfig = {
  apiKey: "AIzaSyARkm1CBiNsXUS6DgmQGnK9GvRZhTiwKOM",
  authDomain: "toko-ghani-f2f67.firebaseapp.com",
  databaseURL: "https://toko-ghani-f2f67-default-rtdb.firebaseio.com",
  projectId: "toko-ghani-f2f67",
  storageBucket: "toko-ghani-f2f67.appspot.com",
  messagingSenderId: "177481860025",
  appId: "1:177481860025:web:ed62358c58cc309ade2c68"
};

firebase.initializeApp(firebaseConfig);
var db = firebase.database();

function addProduct() {
  let name = document.getElementById("name").value;
  let price = document.getElementById("price").value;
  let stock = document.getElementById("stock").value;
  let file = document.getElementById("image").files[0];

  if (!name || !price || !stock || !file) {
    alert("Lengkapi semua data & upload foto!");
    return;
  }

  let reader = new FileReader();
  reader.onload = function() {
    let newRef = db.ref("products").push();
    newRef.set({
      name: name,
      price: price,
      stock: stock,
      image: reader.result
    });

    document.getElementById("name").value = "";
    document.getElementById("price").value = "";
    document.getElementById("stock").value = "";
    document.getElementById("image").value = "";
  };
  reader.readAsDataURL(file);
}

db.ref("products").on("value", snapshot => {
  let list = document.getElementById("list");
  list.innerHTML = "";

  snapshot.forEach(child => {
    let p = child.val();
    let div = document.createElement("div");
    div.className = "product";
    div.innerHTML = `
      <b>${p.name}</b><br>
      Rp ${p.price}<br>
      Stok: ${p.stock}<br>
      <img src="${p.image}">
    `;
    list.appendChild(div);
  });
});
</script>

</body>
</html>
